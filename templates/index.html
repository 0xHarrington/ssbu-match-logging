<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smash Match Logger</title>
    <style>
        :root {
            /* Gruvbox colors */
            --bg: #282828;
            --bg1: #3c3836;
            --bg-light: #504945;
            --fg: #ebdbb2;
            --green: #98971a;
            --red: #cc241d;
            --blue: #458588;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--bg);
            color: var(--fg);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card {
            background-color: var(--bg1);
            border-radius: 12px;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .card h1 {
            text-align: center;
            margin-bottom: 1.5rem;
            color: var(--fg);
            font-size: 1.8rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--fg);
        }

        select,
        input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--bg-light);
            border-radius: 6px;
            background-color: var(--bg);
            color: var(--fg);
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        select:focus,
        input:focus {
            outline: none;
            border-color: var(--blue);
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        button {
            padding: 0.75rem;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .winner-button {
            background-color: var(--bg-light);
            color: var(--fg);
        }

        .winner-button:hover {
            background-color: var(--bg);
        }

        .winner-button.selected {
            background-color: var(--green);
            color: white;
        }

        .submit-button {
            width: 100%;
            background-color: var(--blue);
            color: white;
        }

        .submit-button:hover {
            opacity: 0.9;
        }

        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .success-message {
            text-align: center;
            color: var(--green);
            margin-top: 1rem;
            display: none;
        }

        #stocksGroup {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .stocks-button-group {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1rem;
        }

        .stocks-button {
            background-color: var(--bg-light);
            color: var(--fg);
        }

        .stocks-button:hover {
            background-color: var(--bg);
        }

        .stocks-button.selected {
            background-color: var(--green);
            color: white;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body>
    <div class="card">
        <h1>Smash Match Logger</h1>

        <div class="form-group">
            <label for="shayneCharacter">Shayne's Character</label>
            <select id="shayneCharacter" required>
                <option value="">Select character...</option>
            </select>
        </div>

        <div class="form-group">
            <label for="mattCharacter">Matt's Character</label>
            <select id="mattCharacter" required>
                <option value="">Select character...</option>
            </select>
        </div>

        <div class="button-group">
            <button class="winner-button" onclick="selectWinner('Shayne')">Shayne Won</button>
            <button class="winner-button" onclick="selectWinner('Matt')">Matt Won</button>
        </div>

        <div id="stocksGroup" class="form-group">
            <label>Stocks Remaining</label>
            <div class="stocks-button-group">
                <button class="stocks-button" onclick="selectStocks(1)">1</button>
                <button class="stocks-button" onclick="selectStocks(2)">2</button>
                <button class="stocks-button" onclick="selectStocks(3)">3</button>
            </div>
        </div>

        <button class="submit-button" onclick="submitGame()">Log Game</button>
        <div id="successMessage" class="success-message">Game logged successfully!</div>
    </div>

    <script>
        let selectedStocks = null;
        let selectedWinner = null;
        const characters = [
            // Original 8
            "Mario", "Donkey Kong", "Link", "Samus", "Dark Samus", "Yoshi", "Kirby", "Fox", "Pikachu",

            // Remaining Base Roster
            "Luigi", "Ness", "Captain Falcon", "Jigglypuff", "Peach", "Daisy", "Bowser", "Ice Climbers",
            "Sheik", "Zelda", "Dr. Mario", "Pichu", "Falco", "Marth", "Lucina", "Young Link",
            "Ganondorf", "Mewtwo", "Roy", "Chrom", "Mr. Game & Watch", "Meta Knight", "Pit",
            "Dark Pit", "Zero Suit Samus", "Wario", "Snake", "Ike", "Pokemon Trainer", "Diddy Kong",
            "Lucas", "Sonic", "King Dedede", "Olimar", "Lucario", "R.O.B.", "Toon Link", "Wolf",
            "Villager", "Mega Man", "Wii Fit Trainer", "Rosalina & Luma", "Little Mac", "Greninja",
            "Mii Brawler", "Mii Swordfighter", "Mii Gunner", "Palutena", "Pac-Man", "Robin",
            "Shulk", "Bowser Jr.", "Duck Hunt", "Ryu", "Ken", "Cloud", "Corrin", "Bayonetta",
            "Inkling", "Ridley", "Simon", "Richter", "King K. Rool", "Isabelle", "Incineroar",

            // Fighters Pass Vol. 1
            "Piranha Plant", "Joker", "Hero", "Banjo & Kazooie", "Terry", "Byleth",

            // Fighters Pass Vol. 2
            "Min Min", "Steve", "Sephiroth", "Pyra/Mythra", "Kazuya", "Sora"
        ].sort();  // Sort alphabetically for easier selection

        function selectStocks(stocks) {
            selectedStocks = stocks;
            document.querySelectorAll('.stocks-button').forEach(btn => {
                btn.classList.remove('selected');
                if (btn.textContent === stocks.toString()) {
                    btn.classList.add('selected');
                }
            });
        }

        function populateCharacters() {
            const dropdowns = [
                document.getElementById('shayneCharacter'),
                document.getElementById('mattCharacter')
            ];

            dropdowns.forEach(dropdown => {
                characters.forEach(char => {
                    const option = document.createElement('option');
                    option.value = char;
                    option.textContent = char;
                    dropdown.appendChild(option);
                });
            });
        }

        function selectWinner(winner) {
            selectedWinner = winner;
            document.querySelectorAll('.winner-button').forEach(btn => {
                btn.classList.remove('selected');
                if (btn.textContent.includes(winner)) {
                    btn.classList.add('selected');
                }
            });

            const stocksGroup = document.getElementById('stocksGroup');
            stocksGroup.style.display = 'block';
        }

        async function submitGame() {
            if (!selectedWinner) {
                alert('Please select a winner');
                return;
            }

            const shayneCharacter = document.getElementById('shayneCharacter').value;
            const mattCharacter = document.getElementById('mattCharacter').value;

            if (!shayneCharacter || !mattCharacter) {
                alert('Please select characters for both players');
                return;
            }

            if (selectedStocks === null) {
                alert('Please select the number of stocks remaining');
                return;
            }

            try {
                const response = await fetch('/log_game', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        shayneCharacter,
                        mattCharacter,
                        winner: selectedWinner,
                        stocksRemaining: selectedStocks
                    })
                });

                if (response.ok) {
                    const successMessage = document.getElementById('successMessage');
                    successMessage.style.display = 'block';

                    // Reset form
                    document.getElementById('shayneCharacter').value = '';
                    document.getElementById('mattCharacter').value = '';
                    selectedWinner = null;
                    selectedStocks = null;
                    document.querySelectorAll('.winner-button, .stocks-button').forEach(btn => {
                        btn.classList.remove('selected');
                    });
                    document.getElementById('stocksGroup').style.display = 'none';

                    // Hide success message after 3 seconds
                    setTimeout(() => {
                        successMessage.style.display = 'none';
                    }, 3000);
                } else {
                    alert('Failed to log game');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Failed to log game');
            }
        }

        // Initialize character dropdowns
        populateCharacters();
    </script>
</body>

</html>